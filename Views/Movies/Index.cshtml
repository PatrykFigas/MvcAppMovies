@model List<MvcAppMovies.Models.Movie>

<h1>Lista filmów</h1>

<a asp-action="Add" class="btn btn-add-movie mb-4">
    + Dodaj nowy film
</a>

@{
    int lp = 1;
}

<div class="table-wrap p-3">
    <table class="table table-hover align-middle mb-0">
        <thead>
            <tr>
                <th class="text-center">Lp.</th>
                <th>Tytuł</th>
                <th class="text-center">Czas (min)</th>
                <th>Reżyser</th>
                <th class="text-center">Akcje</th>
            </tr>
        </thead>

        <tbody>
            @foreach (var movie in Model)
            {
                <tr>
                    <td>@lp</td>
                    <td>@movie.Tytul</td>
                    <td>@movie.Dlugosc</td>
                    <td>@movie.Rezyser</td>
                    <td class="text-nowrap">
                        <a class="btn btn-sm btn-outline-info"
                           asp-action="Details" asp-route-id="@movie.Id">
                            Szczegóły
                        </a>
                        <a class="btn btn-sm btn-outline-warning"
                           asp-action="Edit" asp-route-id="@movie.Id">
                            Edytuj
                        </a>

                        <button class="btn btn-sm btn-outline-danger"
                                data-bs-toggle="modal"
                                data-bs-target="#deleteModal"
                                data-id="@movie.Id">
                            Usuń
                        </button>
                    </td>
                </tr>
                lp++;
            }
        </tbody>
    </table>
</div>

<!-- Modal potwierdzenia usunięcia -->
<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Potwierdzenie usunięcia</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                Czy na pewno chcesz usunąć ten film?
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    Anuluj
                </button>
                <a id="confirmDeleteBtn" class="btn btn-danger">
                    Usuń
                </a>
            </div>

        </div>
    </div>
</div>

<script>
    const deleteModal = document.getElementById('deleteModal');
    deleteModal.addEventListener('show.bs.modal', function (event) {
        const button = event.relatedTarget;
        const movieId = button.getAttribute('data-id');
        document.getElementById('confirmDeleteBtn').href = '/Movies/Delete/' + movieId;
    });
</script>
